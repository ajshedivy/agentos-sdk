---
phase: 05-resource-expansion
plan: 05
subsystem: api
tags: [traces, metrics, observability, monitoring, typescript]

# Dependency graph
requires:
  - phase: 03-type-generation
    provides: OpenAPI-generated types for TraceSummary, TraceDetail, MetricsResponse
  - phase: 02-core-infrastructure
    provides: AgentOSClient with request() method
provides:
  - TracesResource class with list (filtering) and get methods
  - MetricsResource class with get (date filtering) and refresh methods
  - Read-only observability resources for monitoring and debugging
affects: [06-client-integration, documentation]

# Tech tracking
tech-stack:
  added: []
  patterns:
    - Read-only resource pattern (no create/update/delete)
    - URLSearchParams for query param building with conditional inclusion
    - Date range filtering via startingDate/endingDate options

key-files:
  created:
    - src/resources/traces.ts
    - src/resources/metrics.ts
    - tests/resources/traces.test.ts
    - tests/resources/metrics.test.ts
  modified: []

key-decisions:
  - "TracesResource is read-only (no create/update/delete operations)"
  - "MetricsResource is read-only except for refresh trigger"
  - "Query params use snake_case for API compatibility (run_id, session_id, etc.)"
  - "Only defined option values are included in query params"

patterns-established:
  - "Read-only resource pattern: list() and get() only, no mutating operations"
  - "URLSearchParams pattern: build query string from options object, only append defined values"
  - "Date filtering pattern: startingDate/endingDate mapped to starting_date/ending_date"

# Metrics
duration: 2min
completed: 2026-01-31
---

# Phase 05 Plan 05: TracesResource and MetricsResource Summary

**Read-only observability resources for trace retrieval and metrics access with filtering and pagination**

## Performance

- **Duration:** 2 min
- **Started:** 2026-02-01T00:28:37Z
- **Completed:** 2026-02-01T00:30:59Z
- **Tasks:** 3
- **Files modified:** 4

## Accomplishments
- TracesResource class with list (7 filter options) and get methods
- MetricsResource class with get (date range) and refresh methods
- 26 tests passing (17 traces + 9 metrics)
- Complete query param handling with URLSearchParams

## Task Commits

Each task was committed atomically:

1. **Task 1: Create TracesResource class** - `fc7af63` (feat)
2. **Task 2: Create MetricsResource class** - `2a62719` (feat)
3. **Task 3: Create tests for TracesResource and MetricsResource** - `a91112f` (test)

## Files Created/Modified
- `src/resources/traces.ts` - TracesResource class with list (filtering: runId, sessionId, userId, agentId, status, page, limit) and get methods
- `src/resources/metrics.ts` - MetricsResource class with get (date filtering: startingDate, endingDate) and refresh methods
- `tests/resources/traces.test.ts` - 17 tests for TracesResource (query params, URL encoding, error handling)
- `tests/resources/metrics.test.ts` - 9 tests for MetricsResource (date params, refresh, error handling)

## Decisions Made
- TracesResource is read-only (no create/update/delete) - traces are generated by runs, not manually created
- MetricsResource is read-only except for refresh trigger - metrics are computed, not user-managed
- Query params use snake_case (run_id, session_id, starting_date, ending_date) for API compatibility
- URLSearchParams pattern: only include defined option values to avoid sending empty params

## Deviations from Plan

None - plan executed exactly as written.

## Issues Encountered

None

## User Setup Required

None - no external service configuration required.

## Next Phase Readiness

Ready for Phase 6 (Client Integration):
- TracesResource and MetricsResource classes implemented
- All tests passing (26 new tests)
- Need to add client.traces and client.metrics properties
- Need to export TracesResource, MetricsResource, and option types from index.ts

No blockers or concerns.

---
*Phase: 05-resource-expansion*
*Completed: 2026-01-31*

---
phase: 05-resource-expansion
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/resources/teams.ts
  - tests/resources/teams.test.ts
autonomous: true

must_haves:
  truths:
    - "User can list all teams via client.teams.list()"
    - "User can get team details via client.teams.get(teamId)"
    - "User can run team (non-streaming) via client.teams.run(teamId, options)"
    - "User can run team (streaming) via client.teams.runStream(teamId, options)"
    - "User can cancel team run via client.teams.cancel(teamId, runId)"
  artifacts:
    - path: "src/resources/teams.ts"
      provides: "TeamsResource class with list, get, run, runStream, continue, cancel methods"
      exports: ["TeamsResource", "TeamRunOptions", "TeamStreamRunOptions", "TeamContinueOptions"]
    - path: "tests/resources/teams.test.ts"
      provides: "Tests for TeamsResource"
      min_lines: 200
  key_links:
    - from: "src/resources/teams.ts"
      to: "src/client.ts"
      via: "receives AgentOSClient instance in constructor"
      pattern: "constructor.*AgentOSClient"
    - from: "src/resources/teams.ts"
      to: "src/streaming/stream.ts"
      via: "returns AgentStream from runStream/continue"
      pattern: "AgentStream\\.fromSSEResponse"
---

<objective>
Create TeamsResource class that mirrors AgentsResource exactly.

Purpose: Enable running teams with streaming support following the established AgentsResource pattern.
Output: TeamsResource class with full test coverage, ready for client integration.
</objective>

<execution_context>
@/Users/adamshedivy/.claude/get-shit-done/workflows/execute-plan.md
@/Users/adamshedivy/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-resource-expansion/05-RESEARCH.md

# Reference for pattern
@src/resources/agents.ts
@tests/resources/agents.test.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create TeamsResource class</name>
  <files>src/resources/teams.ts</files>
  <action>
Create TeamsResource class that mirrors AgentsResource exactly:

1. Copy structure from src/resources/agents.ts
2. Replace all "agents" with "teams" in paths
3. Replace "AgentsResource" with "TeamsResource"
4. Replace "AgentResponse" with "TeamResponse" from generated types
5. Rename option interfaces: RunOptions -> TeamRunOptions, StreamRunOptions -> TeamStreamRunOptions, ContinueOptions -> TeamContinueOptions (avoid naming conflicts)

Methods to implement (all identical to AgentsResource):
- list(): Promise<TeamResponse[]> - GET /teams
- get(teamId: string): Promise<TeamResponse> - GET /teams/{teamId}
- run(teamId: string, options: TeamRunOptions): Promise<unknown> - POST /teams/{teamId}/runs with FormData
- runStream(teamId: string, options: TeamStreamRunOptions): Promise<AgentStream> - POST /teams/{teamId}/runs with stream=true
- continue(teamId: string, runId: string, options: TeamContinueOptions): Promise<AgentStream | unknown> - POST /teams/{teamId}/runs/{runId}/continue
- cancel(teamId: string, runId: string): Promise<void> - POST /teams/{teamId}/runs/{runId}/cancel

Use components["schemas"]["TeamResponse"] for return type.
All path parameters must use encodeURIComponent().
  </action>
  <verify>
File exists and TypeScript compiles: `npm run build`
  </verify>
  <done>
TeamsResource class created with all methods, types imported correctly, paths use /teams.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create TeamsResource tests</name>
  <files>tests/resources/teams.test.ts</files>
  <action>
Create comprehensive tests for TeamsResource mirroring tests/resources/agents.test.ts:

1. Copy test structure from agents.test.ts
2. Replace all references to AgentsResource with TeamsResource
3. Update import path to "../../src/resources/teams"
4. Verify all path assertions use "/teams" not "/agents"

Test coverage to include:
- list() - returns array, propagates errors, handles empty array
- get() - returns team by ID, URL-encodes special characters (/, space, @), handles empty string ID
- run() - FormData with message/stream=false, includes session_id/user_id when provided, URL-encodes teamId
- runStream() - returns AgentStream, builds FormData with stream=true, passes AbortController
- continue() - returns AgentStream when streaming (default), returns result when stream=false, includes tools/session_id/user_id
- cancel() - calls correct endpoint, URL-encodes IDs

Critical path verification in each test: ensure endpoint uses "/teams" not "/agents"
  </action>
  <verify>
Tests pass: `npm test -- tests/resources/teams.test.ts`
  </verify>
  <done>
All TeamsResource tests pass, verifying correct /teams paths and FormData construction.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` - TypeScript compiles without errors
2. `npm test -- tests/resources/teams.test.ts` - All tests pass
3. `grep -r "/agents" src/resources/teams.ts` - Returns no matches (no accidental /agents paths)
</verification>

<success_criteria>
- TeamsResource class exists with list, get, run, runStream, continue, cancel methods
- All methods use /teams paths (not /agents)
- All tests pass (~30+ tests mirroring agents.test.ts)
- TypeScript compiles with no errors
</success_criteria>

<output>
After completion, create `.planning/phases/05-resource-expansion/05-01-SUMMARY.md`
</output>

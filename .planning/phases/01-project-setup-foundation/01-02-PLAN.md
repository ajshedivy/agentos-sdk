---
phase: 01-project-setup-foundation
plan: 02
type: execute
wave: 2
depends_on: ["01-01"]
files_modified:
  - src/index.ts
  - tests/index.test.ts
  - vitest.config.ts
autonomous: true

must_haves:
  truths:
    - "npm run build produces dist/ with index.js, index.cjs, and .d.ts files"
    - "npm run test passes with at least one test"
    - "npm run validate passes publint and attw checks"
  artifacts:
    - path: "src/index.ts"
      provides: "Package entry point with placeholder export"
      min_lines: 5
    - path: "tests/index.test.ts"
      provides: "Test file verifying placeholder export"
      contains: "expect"
    - path: "vitest.config.ts"
      provides: "Test runner configuration"
      contains: "defineConfig"
    - path: "dist/index.js"
      provides: "ESM build output"
    - path: "dist/index.cjs"
      provides: "CJS build output"
    - path: "dist/index.d.ts"
      provides: "TypeScript declarations"
  key_links:
    - from: "tests/index.test.ts"
      to: "src/index.ts"
      via: "import statement"
      pattern: "from ['\"]\\.\\.?/src"
    - from: "vitest.config.ts"
      to: "tests/"
      via: "test file discovery"
      pattern: "include.*tests"
---

<objective>
Configure test runner, create placeholder source files, and validate the complete package configuration.

Purpose: Complete the foundation by adding the test infrastructure and validating that the entire build/test/lint/package pipeline works correctly. This proves the dual ESM/CJS configuration is correct before any real code is written.

Output: Fully working development environment where `npm run build`, `npm run test`, and `npm run validate` all pass.
</objective>

<execution_context>
@/Users/adamshedivy/.claude/get-shit-done/workflows/execute-plan.md
@/Users/adamshedivy/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-project-setup-foundation/01-CONTEXT.md
@.planning/phases/01-project-setup-foundation/01-RESEARCH.md
@.planning/phases/01-project-setup-foundation/01-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Configure Vitest test runner</name>
  <files>vitest.config.ts</files>
  <action>
Create vitest.config.ts:

```typescript
import { defineConfig } from 'vitest/config'

export default defineConfig({
  test: {
    globals: false,
    environment: 'node',
    include: ['tests/**/*.test.ts'],
    coverage: {
      provider: 'v8',
      reporter: ['text', 'json', 'html'],
      exclude: [
        'dist/**',
        'tests/**',
        '**/*.config.ts'
      ]
    }
  }
})
```

NOTE: globals: false means we use explicit imports (import { describe, it, expect } from 'vitest'). This is preferred for SDK code clarity.

NOTE: No coverage thresholds per CONTEXT.md decision - report only, don't fail builds.
  </action>
  <verify>
- vitest.config.ts exists
- File is valid TypeScript (no syntax errors)
  </verify>
  <done>
Vitest configured for Node.js environment with explicit imports and coverage reporting.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create placeholder source and test files</name>
  <files>src/index.ts, tests/index.test.ts</files>
  <action>
Create src/ directory and src/index.ts:

```typescript
/**
 * AgentOS TypeScript SDK
 *
 * @packageDocumentation
 */

/**
 * SDK version number
 */
export const VERSION = '0.1.0'

/**
 * Placeholder for AgentOSClient class (implemented in Phase 2)
 */
export class AgentOSClient {
  readonly version = VERSION

  constructor() {
    // Placeholder - real implementation in Phase 2
  }
}
```

Create tests/ directory and tests/index.test.ts:

```typescript
import { describe, it, expect } from 'vitest'
import { AgentOSClient, VERSION } from '../src/index'

describe('AgentOSClient', () => {
  it('should export VERSION constant', () => {
    expect(VERSION).toBe('0.1.0')
  })

  it('should instantiate AgentOSClient', () => {
    const client = new AgentOSClient()
    expect(client).toBeInstanceOf(AgentOSClient)
    expect(client.version).toBe('0.1.0')
  })
})
```

WHY placeholder class: We need real exports to validate the full build pipeline (tsup dts generation, type resolution across formats). A minimal class exercises the same code paths as the full implementation.
  </action>
  <verify>
- `npm run test` passes with 2 tests
- `npm run build` completes without errors
- dist/ contains: index.js, index.cjs, index.d.ts (and .map files)
  </verify>
  <done>
Placeholder source and test files created. Build produces all expected outputs. Tests pass.
  </done>
</task>

<task type="auto">
  <name>Task 3: Validate complete package configuration</name>
  <files>(validation only - no files modified)</files>
  <action>
Run the full validation pipeline:

1. Run `npm run build` - verify dist/ output structure
2. Run `npm run test` - verify tests pass
3. Run `npm run lint` - verify no lint errors
4. Run `npm run typecheck` - verify TypeScript compilation
5. Run `npm run validate` - verify publint and attw pass

Expected dist/ structure after build:
```
dist/
  index.js       # ESM output
  index.js.map   # ESM source map
  index.cjs      # CJS output
  index.cjs.map  # CJS source map
  index.d.ts     # Type declarations
  index.d.mts    # ESM type declarations (or may be same as .d.ts)
  index.d.cts    # CJS type declarations (or may be same as .d.ts)
```

If publint or attw report warnings:
- EXPORTS_TYPES_SHOULD_BE_FIRST: Fix types ordering in package.json exports
- Resolution failures: May need to adjust tsup dts configuration

If warnings appear, fix them before marking task complete.
  </action>
  <verify>
- `npm run validate` exits with code 0
- publint reports no errors (warnings about missing README/LICENSE are ok)
- attw reports no type resolution problems
  </verify>
  <done>
Full validation pipeline passes. Package correctly configured for dual ESM/CJS distribution with proper type resolution.
  </done>
</task>

</tasks>

<verification>
Phase 1 Success Criteria (from ROADMAP.md):

1. [x] Package builds successfully to both ESM and CommonJS formats
   - Verify: `ls dist/` shows index.js (ESM) and index.cjs (CJS)

2. [x] TypeScript strict mode enabled with zero compiler errors
   - Verify: `npm run typecheck` passes, tsconfig.json has "strict": true

3. [x] Development environment runs tests and linting without errors
   - Verify: `npm run test` passes, `npm run lint` passes

4. [x] Package structure verified by publint.dev with no dual-package hazard warnings
   - Verify: `npm run validate` passes (publint + attw)

Additional verification:
- Test import in ESM context: `node --input-type=module -e "import { AgentOSClient } from './dist/index.js'; console.log(new AgentOSClient().version)"`
- Test require in CJS context: `node -e "const { AgentOSClient } = require('./dist/index.cjs'); console.log(new AgentOSClient().version)"`
</verification>

<success_criteria>
- npm run build produces dual ESM/CJS output
- npm run test passes with all tests green
- npm run lint reports no errors
- npm run validate passes publint and attw checks
- Both ESM import and CJS require work correctly
</success_criteria>

<output>
After completion, create `.planning/phases/01-project-setup-foundation/01-02-SUMMARY.md`
</output>

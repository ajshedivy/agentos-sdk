---
phase: 01-project-setup-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - tsconfig.json
  - tsup.config.ts
  - biome.json
  - .gitignore
autonomous: true

must_haves:
  truths:
    - "npm install completes without errors"
    - "npm run build produces dist/ with ESM and CJS outputs"
    - "npm run lint runs without configuration errors"
  artifacts:
    - path: "package.json"
      provides: "Dual ESM/CJS package configuration"
      contains: '"type": "module"'
    - path: "tsconfig.json"
      provides: "TypeScript strict mode configuration"
      contains: '"strict": true'
    - path: "tsup.config.ts"
      provides: "Build configuration for dual format output"
      contains: "format: ['esm', 'cjs']"
    - path: "biome.json"
      provides: "Linting configuration"
      contains: '"linter"'
  key_links:
    - from: "package.json"
      to: "tsup.config.ts"
      via: "build script"
      pattern: '"build":\\s*"tsup"'
    - from: "package.json"
      to: "biome.json"
      via: "lint script"
      pattern: '"lint":\\s*"biome'
---

<objective>
Initialize the npm package with dual ESM/CJS configuration, TypeScript strict mode, and build tooling.

Purpose: Establish the foundational package structure that all subsequent phases will build upon. Getting this right from day one prevents painful migrations later (cannot fix post-release without major version bump).

Output: Working build pipeline that produces both ESM (.js) and CJS (.cjs) outputs with proper type declarations.
</objective>

<execution_context>
@/Users/adamshedivy/.claude/get-shit-done/workflows/execute-plan.md
@/Users/adamshedivy/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-project-setup-foundation/01-CONTEXT.md
@.planning/phases/01-project-setup-foundation/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize package with dual ESM/CJS configuration</name>
  <files>package.json, .gitignore</files>
  <action>
Create package.json with the following configuration (use exact structure from RESEARCH.md):

```json
{
  "name": "@ajshedivy/agentos-sdk",
  "version": "0.1.0",
  "description": "TypeScript SDK for AgentOS HTTP API",
  "type": "module",
  "main": "./dist/index.cjs",
  "module": "./dist/index.js",
  "types": "./dist/index.d.ts",
  "exports": {
    ".": {
      "types": "./dist/index.d.ts",
      "import": {
        "types": "./dist/index.d.mts",
        "default": "./dist/index.js"
      },
      "require": {
        "types": "./dist/index.d.cts",
        "default": "./dist/index.cjs"
      }
    }
  },
  "files": ["dist", "README.md", "LICENSE"],
  "scripts": {
    "build": "tsup",
    "test": "vitest run",
    "test:watch": "vitest",
    "test:coverage": "vitest run --coverage",
    "lint": "biome check .",
    "lint:fix": "biome check --write .",
    "typecheck": "tsc --noEmit",
    "validate": "npm run build && publint && attw --pack ."
  },
  "engines": {
    "node": ">=18.0.0"
  },
  "keywords": ["agentos", "sdk", "api-client", "typescript"],
  "author": "Adam Shedivy",
  "license": "MIT",
  "repository": {
    "type": "git",
    "url": "git+https://github.com/ajshedivy/agentos-sdk.git"
  },
  "devDependencies": {
    "@arethetypeswrong/cli": "^0.17.0",
    "@biomejs/biome": "^1.9.4",
    "publint": "^0.2.12",
    "tsup": "^8.3.5",
    "typescript": "^5.7.2",
    "vitest": "^2.1.8"
  }
}
```

Create .gitignore with:
```
node_modules/
dist/
coverage/
*.tgz
.DS_Store
```

Run `npm install` to install dependencies.

CRITICAL: The exports field order matters - "types" must come first within each condition block. This prevents TypeScript resolution failures.
  </action>
  <verify>
- `npm install` completes without errors
- `node_modules/` directory created with dependencies
- `package-lock.json` generated
  </verify>
  <done>
Package initialized with all devDependencies installed. Exports field correctly configured for dual ESM/CJS with proper type resolution order.
  </done>
</task>

<task type="auto">
  <name>Task 2: Configure TypeScript with strict mode</name>
  <files>tsconfig.json</files>
  <action>
Create tsconfig.json with strict mode and all additional strict checks:

```json
{
  "compilerOptions": {
    "target": "ES2022",
    "module": "ESNext",
    "lib": ["ES2022"],
    "moduleResolution": "bundler",

    "strict": true,
    "noUncheckedIndexedAccess": true,
    "noImplicitReturns": true,
    "noFallthroughCasesInSwitch": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "forceConsistentCasingInFileNames": true,

    "declaration": true,
    "declarationMap": true,
    "sourceMap": true,

    "outDir": "./dist",
    "rootDir": "./src",

    "esModuleInterop": true,
    "skipLibCheck": true,
    "isolatedModules": true
  },
  "include": ["src/**/*"],
  "exclude": ["node_modules", "dist", "tests"]
}
```

NOTE: We use moduleResolution "bundler" because tsup handles module resolution. This is the correct setting for bundled libraries per TypeScript 5.x recommendations.
  </action>
  <verify>
- `npx tsc --noEmit` runs without error (may warn about missing src/, that's ok)
- tsconfig.json contains "strict": true
  </verify>
  <done>
TypeScript configured with strict mode enabled. All additional strict checks enabled for SDK-quality type safety.
  </done>
</task>

<task type="auto">
  <name>Task 3: Configure build and lint tooling</name>
  <files>tsup.config.ts, biome.json</files>
  <action>
Create tsup.config.ts:

```typescript
import { defineConfig } from 'tsup'

export default defineConfig({
  entry: ['src/index.ts'],
  format: ['esm', 'cjs'],
  dts: true,
  sourcemap: true,
  clean: true,
  splitting: false,
  outExtension({ format }) {
    return {
      js: format === 'esm' ? '.js' : '.cjs'
    }
  }
})
```

Create biome.json:

```json
{
  "$schema": "https://biomejs.dev/schemas/1.9.4/schema.json",
  "organizeImports": {
    "enabled": true
  },
  "linter": {
    "enabled": true,
    "rules": {
      "recommended": true
    }
  },
  "formatter": {
    "enabled": true,
    "indentStyle": "space",
    "indentWidth": 2
  },
  "files": {
    "ignore": ["dist/**", "node_modules/**", "coverage/**"]
  }
}
```

WHY Biome over ESLint: 20x faster (Rust-based), single tool for lint+format, sufficient rules for SDK development. Per CONTEXT.md, this was left to Claude's discretion.
  </action>
  <verify>
- `npm run lint` runs without configuration errors (may show no files to lint, that's ok)
- tsup.config.ts exists and is valid TypeScript
- biome.json exists and is valid JSON
  </verify>
  <done>
Build tooling configured. tsup will output dual ESM/CJS with proper extensions. Biome configured for linting and formatting.
  </done>
</task>

</tasks>

<verification>
After all tasks complete:

1. Run `npm run build` - should fail gracefully (no src/index.ts yet, that's Plan 02)
2. Run `npm run lint` - should run without configuration errors
3. Verify files exist:
   - package.json with "type": "module"
   - tsconfig.json with "strict": true
   - tsup.config.ts with format: ['esm', 'cjs']
   - biome.json with linter enabled
   - .gitignore with dist/ and node_modules/
</verification>

<success_criteria>
- npm install completes with all devDependencies installed
- TypeScript strict mode enabled with zero configuration errors
- Build and lint tooling configured and runnable
- Package.json exports field correctly ordered (types first)
</success_criteria>

<output>
After completion, create `.planning/phases/01-project-setup-foundation/01-01-SUMMARY.md`
</output>
